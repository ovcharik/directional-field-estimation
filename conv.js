(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
importScripts('./libs.js');

new Producer(self, function(data) {
  var a, b, g, h, i, img, j, k, kernel, kh, kw, l, m, n, out, px, py, r, ref, ref1, ref2, ref3, ref4, ref5, ref6, ref7, src, sum, v, w, x, y;
  kernel = data.kernel;
  img = data.imageData;
  h = img.height;
  w = img.width;
  kh = (ref = kernel.length) != null ? ref : 0;
  kw = (ref1 = (ref2 = kernel[0]) != null ? ref2.length : void 0) != null ? ref1 : 0;
  src = img.data;
  out = new Uint8ClampedArray(src.length);
  for (y = k = 0, ref3 = h; 0 <= ref3 ? k < ref3 : k > ref3; y = 0 <= ref3 ? ++k : --k) {
    for (x = l = 0, ref4 = w; 0 <= ref4 ? l < ref4 : l > ref4; x = 0 <= ref4 ? ++l : --l) {
      ref5 = [0, 0, 0, 0, 0], r = ref5[0], g = ref5[1], b = ref5[2], a = ref5[3], sum = ref5[4];
      for (i = m = 0, ref6 = kh; 0 <= ref6 ? m < ref6 : m > ref6; i = 0 <= ref6 ? ++m : --m) {
        for (j = n = 0, ref7 = kw; 0 <= ref7 ? n < ref7 : n > ref7; j = 0 <= ref7 ? ++n : --n) {
          px = x + (j - (kw >> 1));
          py = y + (i - (kh >> 1));
          if (px < 0 || px >= w || py < 0 || py >= h) {
            continue;
          }
          v = kernel[i][j];
          r += src[4 * (w * py + px) + 0] * v;
          g += src[4 * (w * py + px) + 1] * v;
          b += src[4 * (w * py + px) + 2] * v;
          sum += v;
        }
      }
      if (sum <= 0) {
        sum = 1;
      }
      r /= sum | 1;
      if (r < 0) {
        r = 0;
      }
      if (r > 255) {
        r = 255;
      }
      g /= sum | 1;
      if (g < 0) {
        g = 0;
      }
      if (g > 255) {
        g = 255;
      }
      b /= sum | 1;
      if (b < 0) {
        b = 0;
      }
      if (b > 255) {
        b = 255;
      }
      out[4 * (w * y + x) + 0] = r;
      out[4 * (w * y + x) + 1] = g;
      out[4 * (w * y + x) + 2] = b;
      out[4 * (w * y + x) + 3] = 255;
    }
  }
  return {
    imageData: new ImageData(out, w, h)
  };
});



},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9ncnVudC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvaG9tZS9tb3YvZGV2L2RmZS9zcmMvd29ya2Vycy9jb252LmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLGFBQUEsQ0FBYyxXQUFkLENBQUEsQ0FBQTs7QUFBQSxJQUVJLFFBQUEsQ0FBUyxJQUFULEVBQWUsU0FBQyxJQUFELEdBQUE7QUFDakIsTUFBQSxzSUFBQTtBQUFBLEVBQUEsTUFBQSxHQUFTLElBQUksQ0FBQyxNQUFkLENBQUE7QUFBQSxFQUNBLEdBQUEsR0FBTyxJQUFJLENBQUMsU0FEWixDQUFBO0FBQUEsRUFHQSxDQUFBLEdBQUksR0FBRyxDQUFDLE1BSFIsQ0FBQTtBQUFBLEVBSUEsQ0FBQSxHQUFJLEdBQUcsQ0FBQyxLQUpSLENBQUE7QUFBQSxFQU1BLEVBQUEseUNBQXFCLENBTnJCLENBQUE7QUFBQSxFQU9BLEVBQUEsK0VBQXlCLENBUHpCLENBQUE7QUFBQSxFQVNBLEdBQUEsR0FBTSxHQUFHLENBQUMsSUFUVixDQUFBO0FBQUEsRUFVQSxHQUFBLEdBQVUsSUFBQSxpQkFBQSxDQUFrQixHQUFHLENBQUMsTUFBdEIsQ0FWVixDQUFBO0FBWUEsT0FBUywrRUFBVCxHQUFBO0FBQ0UsU0FBUywrRUFBVCxHQUFBO0FBQ0UsTUFBQSxPQUFvQixDQUFDLENBQUQsRUFBSSxDQUFKLEVBQU8sQ0FBUCxFQUFVLENBQVYsRUFBYSxDQUFiLENBQXBCLEVBQUMsV0FBRCxFQUFJLFdBQUosRUFBTyxXQUFQLEVBQVUsV0FBVixFQUFhLGFBQWIsQ0FBQTtBQUVBLFdBQVMsZ0ZBQVQsR0FBQTtBQUNFLGFBQVMsZ0ZBQVQsR0FBQTtBQUNFLFVBQUEsRUFBQSxHQUFLLENBQUEsR0FBSSxDQUFDLENBQUEsR0FBSSxDQUFDLEVBQUEsSUFBTSxDQUFQLENBQUwsQ0FBVCxD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IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJpbXBvcnRTY3JpcHRzICcuL2xpYnMuanMnXG5cbm5ldyBQcm9kdWNlciBzZWxmLCAoZGF0YSkgLT5cbiAga2VybmVsID0gZGF0YS5rZXJuZWxcbiAgaW1nICA9IGRhdGEuaW1hZ2VEYXRhXG5cbiAgaCA9IGltZy5oZWlnaHRcbiAgdyA9IGltZy53aWR0aFxuXG4gIGtoID0ga2VybmVsLmxlbmd0aCA/IDBcbiAga3cgPSBrZXJuZWxbMF0/Lmxlbmd0aCA/IDBcblxuICBzcmMgPSBpbWcuZGF0YVxuICBvdXQgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoc3JjLmxlbmd0aClcblxuICBmb3IgeSBpbiBbMCAuLi4gaF1cbiAgICBmb3IgeCBpbiBbMCAuLi4gd11cbiAgICAgIFtyLCBnLCBiLCBhLCBzdW1dID0gWzAsIDAsIDAsIDAsIDBdXG5cbiAgICAgIGZvciBpIGluIFswIC4uLiBraF1cbiAgICAgICAgZm9yIGogaW4gWzAgLi4uIGt3XVxuICAgICAgICAgIHB4ID0geCArIChqIC0gKGt3ID4+IDEpKVxuICAgICAgICAgIHB5ID0geSArIChpIC0gKGtoID4+IDEpKVxuXG4gICAgICAgICAgY29udGludWUgaWYgcHggPCAwIHx8IHB4ID49IHcgfHwgcHkgPCAwIHx8IHB5ID49IGhcblxuICAgICAgICAgIHYgPSBrZXJuZWxbaV1bal1cbiAgICAgICAgICByICs9IHNyY1s0ICogKHcgKiBweSArIHB4KSArIDBdICogdlxuICAgICAgICAgIGcgKz0gc3JjWzQgKiAodyAqIHB5ICsgcHgpICsgMV0gKiB2XG4gICAgICAgICAgYiArPSBzcmNbNCAqICh3ICogcHkgKyBweCkgKyAyXSAqIHZcbiAgICAgICAgICBzdW0gKz0gdlxuXG4gICAgICBzdW0gPSAxIGlmIHN1bSA8PSAwXG5cbiAgICAgIHIgLz0gc3VtIHwgMVxuICAgICAgciAgPSAwICAgaWYgciA8IDBcbiAgICAgIHIgID0gMjU1IGlmIHIgPiAyNTVcblxuICAgICAgZyAvPSBzdW0gfCAxXG4gICAgICBnICA9IDAgICBpZiBnIDwgMFxuICAgICAgZyAgPSAyNTUgaWYgZyA+IDI1NVxuXG4gICAgICBiIC89IHN1bSB8IDFcbiAgICAgIGIgID0gMCAgIGlmIGIgPCAwXG4gICAgICBiICA9IDI1NSBpZiBiID4gMjU1XG5cbiAgICAgIG91dFs0ICogKHcgKiB5ICsgeCkgKyAwXSA9IHJcbiAgICAgIG91dFs0ICogKHcgKiB5ICsgeCkgKyAxXSA9IGdcbiAgICAgIG91dFs0ICogKHcgKiB5ICsgeCkgKyAyXSA9IGJcbiAgICAgIG91dFs0ICogKHcgKiB5ICsgeCkgKyAzXSA9IDI1NVxuXG4gIHJldHVybiBpbWFnZURhdGE6IG5ldyBJbWFnZURhdGEob3V0LCB3LCBoKVxuIl19
